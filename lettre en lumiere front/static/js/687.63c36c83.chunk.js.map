{"version":3,"file":"static/js/687.63c36c83.chunk.js","mappings":"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","sources":["assets/images/check.svg","components/sequences/Exercices/G.jsx"],"sourcesContent":["var _defs, _g, _text, _text2;\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from \"react\";\nfunction SvgCheck(_ref, svgRef) {\n  let {\n    title,\n    titleId,\n    ...props\n  } = _ref;\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    xmlSpace: \"preserve\",\n    style: {\n      shapeRendering: \"geometricPrecision\",\n      textRendering: \"geometricPrecision\",\n      imageRendering: \"optimizeQuality\"\n    },\n    viewBox: \"0 0 763 752.5\",\n    x: \"0px\",\n    y: \"0px\",\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"style\", {\n    type: \"text/css\"\n  }, \"\\r\\n   \\r\\n    .fil0 {fill:white}\\r\\n   \\r\\n  \"))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", null, /*#__PURE__*/React.createElement(\"path\", {\n    className: \"fil0\",\n    d: \"M65 370c55,41 125,102 166,159 222,-268 232,-311 483,-529l49 0c-218,185 -361,389 -482,586l-80 16c-9,-50 -160,-201 -201,-232l65 0z\"\n  }))), _text || (_text = /*#__PURE__*/React.createElement(\"text\", {\n    x: 0,\n    y: 617,\n    fill: \"#000000\",\n    fontSize: \"5px\",\n    fontWeight: \"bold\",\n    fontFamily: \"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif\"\n  }, \"Created by Andy Mc\")), _text2 || (_text2 = /*#__PURE__*/React.createElement(\"text\", {\n    x: 0,\n    y: 622,\n    fill: \"#000000\",\n    fontSize: \"5px\",\n    fontWeight: \"bold\",\n    fontFamily: \"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif\"\n  }, \"from the Noun Project\")));\n}\nconst ForwardRef = /*#__PURE__*/React.forwardRef(SvgCheck);\nexport default __webpack_public_path__ + \"static/media/check.ecf149c7bad9021580587be9fbf1b5aa.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { LinearCountdown, getElementRandom } from \"../../../hooks/useRandom\";\r\nimport speak from \"../../../hooks/useSpeak\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport checkIcon from '../../../assets/images/check.svg'\r\n\r\nconst G = (props) => {\r\n\r\n    const times = useRef(1);\r\n\r\n    const { data, score, onAttemptMade, isModalOpen, imgNotFound } = props;\r\n    const [tabItems, setTabItems] = useState([]);\r\n    const [displayItems, setDisplayItems] = useState( );\r\n    const [item, setItem] = useState('');\r\n    const [attemptCount, setAttemptCount] = useState(0);\r\n    const [tabResponses, setTabResponses] = useState(new Array(4).fill(null));\r\n    const navigate = useNavigate();\r\n                                                        \r\n  \r\n    useEffect(() => {\r\n        if (data?.choiceDetails || data?.rep_contenu) {\r\n            const initialDisplayItems = (data.choiceDetails || data.rep_contenu).map(el => ({\r\n                value: el.value, \r\n                image: el.file,\r\n                state: 'initial'\r\n            }));\r\n            setDisplayItems(initialDisplayItems);\r\n        }\r\n    }, [data]); \r\n                      \r\n\r\n\r\n    const updateTabItems = useCallback(() => {\r\n      \r\n        if (displayItems?.length > 0) {\r\n\r\n            let newTabGraphemes = []; \r\n            for (let i = 0; i < 3; i++) {\r\n              let candidateItems = getElementRandom(displayItems);\r\n              if (!newTabGraphemes.includes(candidateItems)) {\r\n                newTabGraphemes.push(candidateItems);\r\n              }\r\n            \r\n            setTabItems(newTabGraphemes);\r\n            setItem(getElementRandom(newTabGraphemes)); \r\n           }\r\n        }\r\n         \r\n      }, [displayItems]);// Ajouter data?.content.choices comme dépendance\r\n    \r\n\r\n      useEffect(() => {\r\n        \r\n        updateTabItems();\r\n     }, [updateTabItems]);\r\n\r\n\r\n     useEffect(() => {\r\n        if (item) {\r\n            speak(item.value);\r\n         \r\n        }\r\n    }, [item]);\r\n\r\n    \r\n    const updateExercise = (isCorrect) => { //Sert à update le tableau des réponses et la barre de progression\r\n        setTabResponses(prev => {\r\n            const newResponses = [...prev];\r\n            newResponses[attemptCount] = isCorrect;\r\n            return newResponses;\r\n        });\r\n\r\n    \r\n        setAttemptCount(attemptCount + 1);\r\n    };\r\n\r\n    const handleClick = (index) => {\r\n\r\n\r\n        tabItems?.map((item) => {return {...item, state:'initial'}});\r\n\r\n        const secondes = document.querySelector('.exercice__count');\r\n        const response = tabItems.find((r) => r.textContent === item);\r\n\r\n        if (times.current <= 4){\r\n            times.current += 1; // Incrémente times\r\n            \r\n             //Vérifie si l'élément sélectionné est faux ou pas et met le state de la bonne réponse à juste\r\n            const newTabItems = tabItems.map((el, idx) => {\r\n                if (idx === index) {\r\n                    const isCorrect = el.value === item.value;\r\n                    updateExercise(isCorrect);\r\n                    return { ...el, state: isCorrect ? 'true' : 'false' };\r\n                }\r\n                if (el.value === item){\r\n                    return {...el, state:'true'}\r\n                }\r\n                return el; \r\n            });\r\n            \r\n            setTabItems(newTabItems);\r\n\r\n\r\n            if (times.current <= 4 || secondes.textContent === false) {\r\n                setTimeout(() => {\r\n                    // evt.target.classList.remove('true', 'false');\r\n                    tabItems?.forEach((item) => {return{...item, state: 'initial'}});\r\n                    updateTabItems(); \r\n                    \r\n                }, 1000); \r\n             \r\n            } else {\r\n                const scorePercent = tabResponses.filter(el => el === true).length / tabResponses.length * 100; //Calule le score final basé sur le nombre de true\r\n                score(scorePercent);\r\n            \r\n                setTimeout(() => {\r\n                    tabItems?.forEach((item) => {return{...item, state: 'initial'}});\r\n                  \r\n                    \r\n                    onAttemptMade();\r\n                }, 1000); \r\n           \r\n            }\r\n           console.log('tabItem', tabItems);\r\n        }\r\n    }\r\n\r\n    const handleCountdownFinish = () => {\r\n    \r\n        if (!isModalOpen) { \r\n            const scorePercent = tabResponses.filter(el => el === true).length / tabResponses.length * 100;\r\n            score(scorePercent);\r\n          onAttemptMade();\r\n    \r\n        }\r\n      };\r\n      \r\n    return <React.Fragment>\r\n               <h2 className=\"exercice__consigne\">{data?.exo_instruction}</h2>\r\n               <p className=\"exercice__count\">\r\n                 <LinearCountdown onCountdownFinish={handleCountdownFinish} />\r\n                </p>\r\n            <p className=\"exercice__sound\" onClick={() => speak(item.value)}>?</p>\r\n       \r\n            <ul className=\"list\">\r\n                {tabItems?.map((item, index) => {\r\n                    return <li className={`list__item ${item.state}`}\r\n                               key={index} \r\n                               onClick={()=>handleClick(index)}>{item.value}</li>;\r\n                })}\r\n            </ul>\r\n\r\n            <div className=\"exercice__footer\">\r\n            {  data.exo_type === \"G2\" && <img src={`https://mtsene.lpmiaw.univ-lr.fr/lettrelumiere/public/images/choices/${item.file}`} \r\n                                                                      alt={item.value}\r\n                                                                      className=\"exercice__img\"\r\n                                                                      style={{marginBottom:'1rem'}}\r\n                                                                      onError={(e) => {\r\n                                                                        e.target.src = imgNotFound;\r\n                                                                      }}/>}\r\n                <ul className=\"progress\">\r\n                    {tabResponses.map(response => (\r\n                        <li className={`${response === null ? 'progress__part' : response === true ? 'progress__part progress__part--true' : 'progress__part progress__part--false'}`}></li>\r\n                    ))}\r\n                </ul>\r\n                <button className=\"exercice__valid\" onClick={handleClick}>Ok <img src={checkIcon} alt=\"ok\" /></button>\r\n\r\n            </div>\r\n    </React.Fragment>\r\n}\r\n\r\nexport default G;"],"names":["props","times","useRef","data","score","onAttemptMade","isModalOpen","imgNotFound","tabItems","setTabItems","useState","displayItems","setDisplayItems","item","setItem","attemptCount","setAttemptCount","tabResponses","setTabResponses","Array","fill","useNavigate","useEffect","choiceDetails","rep_contenu","initialDisplayItems","map","el","value","image","file","state","updateTabItems","useCallback","length","newTabGraphemes","i","candidateItems","getElementRandom","includes","push","speak","handleClick","index","secondes","document","querySelector","find","r","textContent","current","newTabItems","idx","isCorrect","prev","newResponses","updateExercise","setTimeout","forEach","scorePercent","filter","console","log","_jsxs","React","children","_jsx","className","exo_instruction","LinearCountdown","onCountdownFinish","handleCountdownFinish","onClick","concat","exo_type","src","alt","style","marginBottom","onError","e","target","response","checkIcon"],"sourceRoot":""}